@page "/vdr"
@using Company_Site.Data;
@using Company_Site.Pages.Components

<p class="fw-bold text-button-heading mb-2">VDR</p>

<Modal Title="File Upload" ShowModal=ShowUploadFileModal>
    <EditForm Model="NewItem" OnValidSubmit="SubmitFiles">
        <div>
            <div class="d-flex align-items-center">
                <p class="mx-1 mb-0">Upload Files</p>
                <p class="mb-0 mx-1"><strong>@Files.Count</strong> File(s) Selected</p>
            </div>
            <div @ondragover:preventDefault=true
                 @ondragover=DraggedOverDropPoint>
                <a class="d-flex align-items-center justify-content-center file-upload-box" 
                @onclick=UploadFiles>
                    <i class="fa fa-upload mx-1"></i>
                    <p class="mb-0">Upload</p>
                </a>
                <div class="@(ShowInputField ? "" : "d-none")">
                    <InputFile id="fileInput" OnChange="FileChanged" @bind-Value="Files" class="form-control file-upload-box" multiple type="file" />
                </div>
            </div>
            <div>
                @foreach(IBrowserFile file in Files)
                {
                    <div class="file-item">
                        <p class="mb-0">@file.Name</p>
                        <a @onclick="@(() => RemoveFile(file))">
                            <i class="fa fa-times"></i>
                        </a>
                    </div>
                }
            </div>
            <div class="d-flex my-3 justify-content-center">
                <input type="submit" value="Upload" class="btn btn-outline-primary mx-1" />
                <a class="btn btn-outline-danger mx-1" @onclick=HideUploadForm>Cancel</a>
            </div>
        </div>
    </EditForm>
</Modal>

<div class="card py-3 px-4">
    <div class="row align-items-center">
        <div class="col-6">
            <h5 class="mb-0">All Files</h5>
        </div>
        <div class="col-6 d-flex justify-content-end">
            <a class="btn btn-outline-primary" @onclick=ShowUploadForm>
                Upload File
            </a>
        </div>
    </div>
    <div class="mt-3">
        <table class="data-table">
            <tr>
                <th>
                    <div>
                        SR
                    </div>
                </th>
                <th>
                    <div>
                        Folder Name
                    </div>
                </th>
                <th>
                    <div>
                        Created On
                    </div>
                </th>
                <th>
                    <div>
                        Created By
                    </div>
                </th>
                <th>
                    <div>
                        Size
                    </div>
                </th>
                <th>
                    <div>
                        Manage
                    </div>
                </th>
            </tr>
            @{
                int index = 1;
                foreach(FileItem item in _fileItems)
                {
                    <tr class="file-row">
                        <td>
                            <div>
                                @index
                            </div>
                        </td>
                        <td>
                            <div>
                                <p class="mb-0 file-name">@item.FileName.Split("$$")[0]</p>
                                <p class="mb-0 file-extension">@(new FileInfo(item.FileName).Extension)</p>
                            </div>
                        </td>
                        <td>
                            <div>
                                @item.CreationDate.ToString("dd-MMM-yyyy")
                            </div>
                        </td>
                        <td>
                            <div>
                                Harshal Gandhi
                            </div>
                        </td>
                        <td>
                            <div>
                                @ToMb(item.File.Size) Mb
                            </div>
                        </td>
                        <td>
                            <div class="btn-row">
                                <a class="row-btn"><i class="fa fa-ellipsis-v"></i></a>
                            </div>
                        </td>
                    </tr>
                    index++;
                }
            }
        </table>
    </div>
</div>

