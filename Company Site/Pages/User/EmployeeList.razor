@page "/employeelist"
@using Company_Site.Base;
@using Company_Site.Data;
@using Company_Site.Pages.Components
@using Radzen.Blazor;
@using Radzen;

<p class="fw-bold text-button-heading mb-2">Employee List</p>

<div class="row">
   
    <div class="col-xl-3 col-lg-5 col-md-6 col-sm-12 px-0 pb-4">
        <ContactList Enteries="Enteries" 
            Title="" 
            GetContactId="@(e => e.Id)" 
            GetContactName="@(e => $"{e.FirstName} {e.LastName}")" 
            OnClick="EditRecord" 
            OnDelete="DeleteRecord"
            ShowDeleteButton=IsAdmin
            AutoSearch=true/>
    </div>

    <!--Form-->
    <div class="col-xl-9 col-lg-7 col-md-6 col-sm-12 px-2 m-0">
        <div class="card py-2 px-2">
            <div class="row">
                <div class="col-md-9">

                    <h3>Full Name: @NewEntry.FirstName @NewEntry.LastName</h3>
                    <h5>Employee ID: @NewEntry.Id</h5>

                    <EditForm Model=NewEntry OnValidSubmit=Save id="employeeForm" class="mt-3">

                        <DataAnnotationsValidator/>

                        <MultiErrorView Errors="_errors"/>

                        <div class="row mt-3">
                            <div class="col-md-5">
                                <label for="firstName">First Name</label>
                                <InputText @bind-Value=NewEntry.FirstName disabled="@(!IsAdmin)" id="firstName" type="text" class="form-control "/>
                            </div>
                            <div class="col-md-2"></div>
                            <div class="col-md-5">
                                <label for="lastName">Last Name</label>
                                <InputText @bind-Value=NewEntry.LastName disabled="@(!IsAdmin)" id="lastName" class="form-control " type="text"/>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-5">
                                <label for="address">Address</label>
                                <InputText @bind-Value=NewEntry.Address disabled="@(!IsAdmin)" id="address" class="form-control "></InputText>
                            </div>
                            <div class="col-md-2"></div>
                            <div class="col-md-5">
                                <label for="city">City</label>
                                <InputText @bind-Value=NewEntry.City disabled="@(!IsAdmin)" id="city" class="form-control " type="text"/>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-5">
                                <label for="employeeCode">Employee Code</label>
                                <InputText @bind-Value=NewEntry.EmployeeCode disabled="@(!IsAdmin)" id="employeeCode" class="form-control " type="text"/>
                            </div>
                            <div class="col-md-2"></div>
                            <div class="col-md-5">
                                <label for="state">State</label>
                                <InputText @bind-Value=NewEntry.State disabled="@(!IsAdmin)" id="state" class="form-control " type="text"/>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-5">
                                <label for="joiningDate">Joining Date</label>
                                <input @bind-value=NewEntry.JoiningDate disabled="@(!IsAdmin)" id="joiningDate" type="date" class="form-control "/>
                            </div>
                            <div class="col-md-2"></div>
                            <div class="col-md-5">
                                <label for="birthday">Birthday</label>
                                <input id="birthday" @bind-value=NewEntry.Birthday disabled="@(!IsAdmin)" class="form-control " type="date"/>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-5">
                                <label for="mobileNumber">Mobile Number</label>
                                <InputText @bind-Value=NewEntry.MobileNumber disabled="@(!IsAdmin)" id="mobileNumber" type="tel" class="form-control "/>
                            </div>
                            <div class="col-md-2"></div>
                            <div class="col-md-5">
                                <label for="email">Email</label>
                                <InputText @bind-Value=NewEntry.Email disabled="@(!IsAdmin)" id="email" class="form-control " type="email"/>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-5">
                                <label for="aadharCard">Aadhar Card</label>
                                <InputText @bind-Value=NewEntry.AadharCard disabled="@(!IsAdmin)" id="aadharCard" type="text" class="form-control "/>
                            </div>
                            <div class="col-md-2"></div>
                            <div class="col-md-5">
                                <label for="landlineNumber">Landline Number</label>
                                <InputText @bind-Value=NewEntry.LandlineNumber disabled="@(!IsAdmin)" id="landlineNumber" class="form-control " type="tel"/>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-5">
                                <label for="department">Department</label>
                                <InputText @bind-Value=NewEntry.Department disabled="@(!IsAdmin)" id="department" class="form-control " type="text"/>
                            </div>
                            <div class="col-md-2"></div>
                            <div class="col-md-5">
                                <label for="role">Pan Card</label>
                                <InputText @bind-Value=NewEntry.PanCard disabled="@(!IsAdmin)" id="role" class="form-control " type="text"/>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-5">
                                <label for="designation">Designation</label>
                                <InputText @bind-Value=NewEntry.Designation id="designation" class="form-control " disabled="@(!IsAdmin)" type="text"/>
                            </div>
                            <div class="col-md-2"></div>
                            <div class="col-md-5">
                                <label for="role">Role</label>
                                <InputSelect @bind-Value=NewEntry.Role disabled="@(!IsAdmin)" class="form-select">
                                    <option selected>---- Select Role</option>
                                    <option value="Admin">Admin</option>
                                    <option value="Officer">Officer</option>
                                    <option value="Supervisor">Supervisor</option>
                                    <option value="DepartmentHead">Department Head</option>
                                </InputSelect>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-5">
                                <label for="officeLocation">Office Location</label>
                                <InputText @bind-Value=NewEntry.OfficeLocation disabled="@(!IsAdmin)" id="officeLocation" class="form-control " type="text"/>
                            </div>
                            <div class="col-md-2"></div>
                            <div class="col-md-5">
                                <label for="position">Position</label>
                                <InputText @bind-Value=NewEntry.Position disabled="@(!IsAdmin)" id="position" class="form-control " type="text"/>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-5">
                                <label for="access">Access</label>
                                <RadzenDropDown Multiple="true" 
										Chips="true"  disabled="@(!IsAdmin)"
										AllowClear="true" 
										AllowFiltering="true" 
										FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive" 
										@bind-Value=@selectedBorrowers
										Data=@Borrowers 
										TextProperty="Company" 
										ValueProperty="BorrowerCode" 
                                        Change="AccessListChanged"
										class="w-100" />
                            </div>
                            <div class="col-md-2"></div>
                            <div class="col-md-5">
                                <label for="access">Password</label>
                                <InputText @bind-Value=Password disabled="@(!IsAdmin)" id="access" class="form-control " type="password"/>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-5">
                                <label for="exitDate">Exit Date</label>
                                <InputText @bind-Value=NewEntry.ExitDate disabled="@(!IsAdmin)" id="exitDate" class="form-control " type="date"/>
                            </div>
                            <div class="col-md-2"></div>
                            <div class="col-md-5">
                                <label for="access">Pages</label>
                                <RadzenDropDown Multiple="true" 
										Chips="true" 
										AllowClear="true" 
										AllowFiltering="true" 
										FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive" 
										@bind-Value=@selectedPages
										Data=@PageAccesses  disabled="@(!IsAdmin)"
										TextProperty="Page" 
										ValueProperty="Page" 
                                        Change="PageAccessChanged"
										class="w-100" />
                            </div>
                        </div>

                        <div class="d-flex justify-content-center mt-3">
                            <a class="btn btn-danger me-3" @onclick=Clear>Clear</a>
                            @if(IsAdmin){
                                <button class="btn btn-primary">@(ShouldAdd ? "Add" : "Edit")</button>                                
                            }
                        </div>
                    </EditForm>
                </div>
                <div class="col-md-3">
                    <div id="marginDiv" class="d-flex w-100 justify-content-center align-items-center mb-0">
                        <div>
                            <div id="imageContainer" class="d-flex align-items-center justify-content-center" style="height: 180px; width: 150px; background-color: rgb(189, 189, 189);">
                                <p id="dpText">Photo here!</p>
                            </div>
                            <label class="btn btn-primary rounded-0" for="employeePhoto" style="width: 150px;">
                                Choose a Photo
                            </label>
                            <InputFile OnChange="ProfileImageChanged" @bind-Value=NewEntry.ProfileImage id="employeePhoto" class="form-control d-none" form="employeeForm" type="file"/>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>